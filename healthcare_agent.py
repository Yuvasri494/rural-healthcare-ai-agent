from flask import Flask, request, jsonify, render_template

app = Flask(__name__)

# Symptom database with multi-language support
symptom_db = {
    "fever": {
        "en": "You may have an infection. Drink plenty of water, take rest, and consult a doctor if it lasts more than 3 days.",
        "ta": "роЙроЩрпНроХро│рпБроХрпНроХрпБ родрпКро▒рпНро▒рпБ роЗро░рпБроХрпНроХро▓ро╛роорпН. роЕродро┐роХ родрогрпНрогрпАро░рпН роХрпБроЯро┐роХрпНроХро╡рпБроорпН, роУропрпНро╡рпБ роОроЯрпБроХрпНроХро╡рпБроорпН, 3 роиро╛роЯрпНроХро│рпБроХрпНроХрпБ роорпЗро▓рпН роирпАроЯро┐родрпНродро╛ро▓рпН рооро░рпБродрпНродрпБро╡ро░рпИ роЕрогрпБроХро╡рпБроорпН.",
        "hi": "рдЖрдкрдХреЛ рд╕рдВрдХреНрд░рдордг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЦреВрдм рдкрд╛рдиреА рдкрд┐рдПрдВ, рдЖрд░рд╛рдо рдХрд░реЗрдВ, рдФрд░ рдЕрдЧрд░ 3 рджрд┐рди рд╕реЗ рдЕрдзрд┐рдХ рд░рд╣реЗ рддреЛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВред"
    },
    "headache": {
        "en": "It may be due to stress or dehydration. Drink water and take rest. If severe, consult a doctor.",
        "ta": "роЗродрпБ роорой роЕро┤рпБродрпНродроорпН роЕро▓рпНро▓родрпБ роирпАро░ро┐ро┤рокрпНрокрпБ роХро╛ро░рогрооро╛роХ роЗро░рпБроХрпНроХро▓ро╛роорпН. родрогрпНрогрпАро░рпН роХрпБроЯро┐родрпНродрпБ роУропрпНро╡рпБ роОроЯрпБроХрпНроХро╡рпБроорпН. роХроЯрпБроорпИропро╛роХ роЗро░рпБроирпНродро╛ро▓рпН рооро░рпБродрпНродрпБро╡ро░рпИ роЕрогрпБроХро╡рпБроорпН.",
        "hi": "рдпрд╣ рддрдирд╛рд╡ рдпрд╛ рдкрд╛рдиреА рдХреА рдХрдореА рдХреЗ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдкрд╛рдиреА рдкрд┐рдПрдВ рдФрд░ рдЖрд░рд╛рдо рдХрд░реЗрдВред рдЕрдЧрд░ рдЬреНрдпрд╛рджрд╛ рд╣реЛ рддреЛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВред"
    },
    "stomach pain": {
        "en": "It may be due to indigestion. Eat light food, drink warm water. If it persists, consult a doctor.",
        "ta": "роЗродрпБ роЪрпЖро░ро┐рооро╛ройроХрпН роХрпЛро│ро╛ро▒ро╛роХ роЗро░рпБроХрпНроХро▓ро╛роорпН. роОро│ро┐родро┐ро▓рпН роЪрпЖро░ро┐ропрпБроорпН роЙрогро╡рпБ роЪро╛рокрпНрокро┐роЯро╡рпБроорпН, ро╡рпЖроирпНроирпАро░рпН роХрпБроЯро┐роХрпНроХро╡рпБроорпН. роирпАроЯро┐родрпНродро╛ро▓рпН рооро░рпБродрпНродрпБро╡ро░рпИ роЕрогрпБроХро╡рпБроорпН.",
        "hi": "рдпрд╣ рдмрджрд╣рдЬрдореА рдХреЗ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╣рд▓реНрдХрд╛ рдЦрд╛рдирд╛ рдЦрд╛рдПрдВ, рдЧреБрдирдЧреБрдирд╛ рдкрд╛рдиреА рдкрд┐рдПрдВред рдЕрдЧрд░ рдмрдирд╛ рд░рд╣реЗ рддреЛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВред"
    },
    "cough": {
        "en": "You may have a common cold. Drink warm fluids, avoid dust and cold drinks. If it lasts more than a week, consult a doctor.",
        "ta": "роЙроЩрпНроХро│рпБроХрпНроХрпБ роЪро╛родро╛ро░рог роЪро│ро┐ роЗро░рпБроХрпНроХро▓ро╛роорпН. роЪрпВроЯро╛рой родро┐ро░ро╡роЩрпНроХро│рпН роХрпБроЯро┐роХрпНроХро╡рпБроорпН, родрпВроЪро┐ рооро▒рпНро▒рпБроорпН роХрпБро│ро┐ро░рпНрокро╛ройроЩрпНроХро│рпИ родро╡ро┐ро░рпНроХрпНроХро╡рпБроорпН. роТро░рпБ ро╡ро╛ро░родрпНродро┐ро▒рпНроХрпБроорпН роорпЗро▓ро╛роХ роирпАроЯро┐родрпНродро╛ро▓рпН рооро░рпБродрпНродрпБро╡ро░рпИ роЕрогрпБроХро╡рпБроорпН.",
        "hi": "рдЖрдкрдХреЛ рд╕рд░реНрджреА рд╣реЛ рд╕рдХрддреА рд╣реИред рдЧрд░реНрдо рддрд░рд▓ рдкрджрд╛рд░реНрде рдкрд┐рдПрдВ, рдзреВрд▓ рдФрд░ рдардВрдбреЗ рдкреЗрдп рд╕реЗ рдмрдЪреЗрдВред рдЕрдЧрд░ рдпрд╣ рдПрдХ рд╕рдкреНрддрд╛рд╣ рд╕реЗ рдЕрдзрд┐рдХ рд░рд╣реЗ рддреЛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВред"
    },
    "diarrhea": {
        "en": "It may be due to infection or food issue. Drink clean water, take oral rehydration salts. If severe, consult a doctor.",
        "ta": "роЗродрпБ родрпКро▒рпНро▒рпБ роЕро▓рпНро▓родрпБ роЙрогро╡рпБ рокро┐ро░роЪрпНроЪройрпИ роХро╛ро░рогрооро╛роХ роЗро░рпБроХрпНроХро▓ро╛роорпН. роЪрпБродрпНродрооро╛рой родрогрпНрогрпАро░рпН роХрпБроЯро┐роХрпНроХро╡рпБроорпН, роУроЖро░рпНроОро╕рпН роХрпБроЯро┐роХрпНроХро╡рпБроорпН. роХроЯрпБроорпИропро╛роХ роЗро░рпБроирпНродро╛ро▓рпН рооро░рпБродрпНродрпБро╡ро░рпИ роЕрогрпБроХро╡рпБроорпН.",
        "hi": "рдпрд╣ рд╕рдВрдХреНрд░рдордг рдпрд╛ рдЦрд╛рдиреЗ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЗ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╕рд╛рдл рдкрд╛рдиреА рдкрд┐рдПрдВ, рдУрдЖрд░рдПрд╕ рдШреЛрд▓ рд▓реЗрдВред рдЕрдЧрд░ рдЧрдВрднреАрд░ рд╣реЛ рддреЛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВред"
    },

    # Emergency symptoms
    "chest pain": {
        "en": "Possible heart-related issue. First Aid: Sit in a comfortable position, keep calm, avoid movement.",
        "ta": "роЗродропроорпН родрпКроЯро░рпНрокро╛рой рокро┐ро░роЪрпНроЪройрпИ роЗро░рпБроХрпНроХро▓ро╛роорпН. роорпБродро▓рпБродро╡ро┐: ро╡роЪродро┐ропро╛рой роиро┐ро▓рпИропро┐ро▓рпН роЙроЯрпНроХро╛ро░ро╡рпБроорпН, роЕроорпИродро┐ропро╛роХ роЗро░рпБроЩрпНроХро│рпН, роЕроЪрпИро╡рпБроХро│рпИ родро╡ро┐ро░рпНроХрпНроХро╡рпБроорпН.",
        "hi": "рд╕рдВрднрд╡рддрдГ рд╣реГрджрдп рд╕реЗ рдЬреБрдбрд╝реА рд╕рдорд╕реНрдпрд╛ред рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░: рдЖрд░рд╛рдо рд╕реЗ рдмреИрдареЗрдВ, рд╢рд╛рдВрдд рд░рд╣реЗрдВ, рдЬреНрдпрд╛рджрд╛ рди рд╣рд┐рд▓реЗрдВред"
    },
    "difficulty breathing": {
        "en": "Possible severe asthma or heart issue. First Aid: Sit upright, loosen tight clothing, stay calm.",
        "ta": "роХроЯрпБроорпИропро╛рой роЖро╕рпНродрпБрооро╛ роЕро▓рпНро▓родрпБ роЗродроп рокро┐ро░роЪрпНроЪройрпИ роЗро░рпБроХрпНроХро▓ро╛роорпН. роорпБродро▓рпБродро╡ро┐: роирпЗро░ро╛роХ роЙроЯрпНроХро╛ро░ро╡рпБроорпН, роЗро▒рпБроХрпНроХрооро╛рой роЙроЯрпИроХро│рпИ родро│ро░рпНродрпНродро╡рпБроорпН, роЕроорпИродро┐ропро╛роХ роЗро░рпБроЩрпНроХро│рпН.",
        "hi": "рд╕рдВрднрд╡рддрдГ рдЧрдВрднреАрд░ рджрдорд╛ рдпрд╛ рд╣реГрджрдп рд╕рдорд╕реНрдпрд╛ред рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░: рд╕реАрдзреЗ рдмреИрдареЗрдВ, рддрдВрдЧ рдХрдкрдбрд╝реЗ рдвреАрд▓реЗ рдХрд░реЗрдВ, рд╢рд╛рдВрдд рд░рд╣реЗрдВред"
    },
    "unconscious": {
        "en": "Emergency condition. First Aid: Check breathing, keep airway clear, place on side position.",
        "ta": "роЕро╡роЪро░ роиро┐ро▓рпИ. роорпБродро▓рпБродро╡ро┐: роЪрпБро╡ро╛роЪродрпНродрпИ роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН, роЪрпБро╡ро╛роЪроХрпН роХрпБро┤ро╛ропрпИ родро┐ро▒роирпНродро╡ро╛ро▒рпБ ро╡рпИродрпНродро┐ро░рпБроЩрпНроХро│рпН, рокроХрпНроХро╡ро╛роЯрпНроЯро┐ро▓рпН рокроЯрпБроХрпНроХро╡ро┐роЯро╡рпБроорпН.",
        "hi": "рдЖрдкрд╛рдд рд╕реНрдерд┐рддрд┐ред рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░: рд╕рд╛рдВрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рд╕рд╛рдВрд╕ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рд╕рд╛рдл рд░рдЦреЗрдВ, рдорд░реАрдЬ рдХреЛ рдХрд░рд╡рдЯ рд▓рд┐рдЯрд╛рдПрдВред"
    },
    "severe bleeding": {
        "en": "Emergency condition. First Aid: Apply direct pressure on wound, keep the person still.",
        "ta": "роЕро╡роЪро░ роиро┐ро▓рпИ. роорпБродро▓рпБродро╡ро┐: роХро╛ропродрпНродро┐ро▓рпН роирпЗро░роЯро┐ропро╛роХ роЕро┤рпБродрпНродроорпН роХрпКроЯрпБроХрпНроХро╡рпБроорпН, роЕроирпНрод роирокро░рпИ роЕроЪрпИропро╛рооро▓рпН ро╡рпИродрпНродро┐ро░рпБроЩрпНроХро│рпН.",
        "hi": "рдЖрдкрд╛рдд рд╕реНрдерд┐рддрд┐ред рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░: рдШрд╛рд╡ рдкрд░ рд╕реАрдзреЗ рджрдмрд╛рд╡ рдбрд╛рд▓реЗрдВ, рдорд░реАрдЬ рдХреЛ рд╕реНрдерд┐рд░ рд░рдЦреЗрдВред"
    }
}

# Emergency keywords
emergency_symptoms = ["chest pain", "difficulty breathing", "unconscious", "severe bleeding"]

@app.route('/')
def home():
    return render_template("index.html")

@app.route('/check', methods=['POST'])
def check_symptom():
    data = request.get_json()
    symptom = data.get("symptom", "").lower()
    lang = data.get("lang", "en")

    if symptom in symptom_db:
        response = symptom_db[symptom][lang]

        # If emergency symptom, add alert
        if symptom in emergency_symptoms:
            if lang == "en":
                response += "\n\nЁЯЪи Emergency alert sent! ЁЯЪС Ambulance will reach in 10 minutes."
            elif lang == "ta":
                response += "\n\nЁЯЪи роЕро╡роЪро░ роОроЪрпНроЪро░ро┐роХрпНроХрпИ роЕройрпБрокрпНрокрокрпНрокроЯрпНроЯродрпБ! ЁЯЪС роЖроорпНрокрпБро▓ройрпНро╕рпН 10 роиро┐рооро┐роЯроЩрпНроХро│ро┐ро▓рпН ро╡ро░рпБроорпН."
            elif lang == "hi":
                response += "\n\nЁЯЪи рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдЕрд▓рд░реНрдЯ рднреЗрдЬрд╛ рдЧрдпрд╛! ЁЯЪС рдПрдореНрдмреБрд▓реЗрдВрд╕ 10 рдорд┐рдирдЯ рдореЗрдВ рдкрд╣реБрдБрдЪ рдЬрд╛рдПрдЧреАред"

        return jsonify({"response": response, "emergency": symptom in emergency_symptoms})
    else:
        return jsonify({"response": "Symptom not found in database.", "emergency": False})

if __name__ == '__main__':
    app.run(debug=True)
